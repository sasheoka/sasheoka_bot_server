# Discord Бот для API Snag

Этот Discord бот предназначен для взаимодействия с API Snag Solutions с использованием предоставленного API ключа. Он позволяет пользователям получать определенные данные (например, историю выполненных квестов) через команды в Discord.

## Структура Проекта

discord_bot/
│
├── .env                # Хранит секретные ключи (DISCORD_TOKEN, SNAG_API_KEY, PROXY_URL) - НЕ ДЕЛИТЕСЬ ЭТИМ ФАЙЛОМ!
├── README.md           # Этот файл (или README_EN.md / README_RU.md)
├── bot.py              # Основной скрипт бота (инициализация, загрузка когов, запуск)
├── requirements.txt    # Зависимости пакетов Python
├── .gitignore          # Указывает Git, какие файлы игнорировать (например, .env, venv)
├── discord_bot.log     # Лог-файл, создаваемый ботом
└── cogs/               # Папка, содержащая модули команд бота (Коги)
    ├── __init__.py     # Делает 'cogs' пакетом Python
    ├── doc_commands.py # Пример Кога для базовых команд (например, ping)
    └── snag_cog.py     # Ког, содержащий команды для API Snag (например, questhistory)
└── venv/               # (Рекомендуется) Папка виртуального окружения

## Инструкция по Настройке

1.  **Клонировать или Скопировать:** Получите копию папки проекта `discord_bot` на ваш локальный компьютер.
2.  **Python:** Убедитесь, что у вас установлен Python версии 3.8 или новее. Скачать можно с [python.org](https://www.python.org/downloads/).
3.  **Перейдите в Папку:** Откройте терминал или командную строку и перейдите в папку проекта:
    ```bash
    cd путь/к/папке/discord_bot
    ```
4.  **Создайте Виртуальное Окружение (Рекомендуется):** Это изолирует зависимости проекта.
    ```bash
    # Windows
    py -m venv venv
    # macOS/Linux
    python3 -m venv venv
    ```
5.  **Активируйте Виртуальное Окружение:**
    ```bash
    # Windows (cmd.exe)
    .\venv\Scripts\activate.bat
    # Windows (PowerShell)
    .\venv\Scripts\Activate.ps1
    # Windows (Git Bash)
    source venv/Scripts/activate
    # macOS/Linux
    source venv/bin/activate
    ```
    *(Вы должны увидеть `(venv)` в начале строки вашего терминала)*
6.  **Установите Зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

## Конфигурация (файл `.env`)

1.  В корневой папке проекта (`discord_bot/`) создайте файл с именем `.env`.
2.  Добавьте в файл `.env` следующие строки, заменив значения-плейсхолдеры вашими реальными ключами:

    ```dotenv
    # .env - Секретные ключи и конфигурация
    DISCORD_TOKEN=ВАШ_ТОКЕН_ДИСКОРД_БОТА_СЮДА
    SNAG_API_KEY=ВАШ_SNAG_API_КЛЮЧ_СЮДА

    # Необязательно: URL прокси-сервера, если нужен (раскомментируйте и заполните ОДНУ строку)
    # PROXY_URL=http://ВАШ_ХОСТ_ПРОКСИ:ПОРТ
    # PROXY_URL=http://ЛОГИН:ПАРОЛЬ@ВАШ_ХОСТ_ПРОКСИ:ПОРТ
    # PROXY_URL=socks5://ВАШ_ХОСТ_ПРОКСИ:ПОРТ
    # PROXY_URL=socks5://ЛОГИН:ПАРОЛЬ@ВАШ_ХОСТ_ПРОКСИ:ПОРТ
    ```

3.  **ВАЖНО:**
    *   Никогда не делитесь вашим файлом `.env`.
    *   Не добавляйте этот файл в систему контроля версий (Git). Файл `.gitignore`, включенный в проект, должен автоматически предотвращать это, если вы используете Git.

## Запуск Бота

1.  Убедитесь, что ваше виртуальное окружение активировано (см. шаг 5 в Настройке).
2.  Запустите основной скрипт бота из папки `discord_bot`:
    ```bash
    # Windows
    py bot.py
    # macOS/Linux
    python3 bot.py
    ```
3.  Вы должны увидеть сообщения в терминале о том, что бот вошел в систему и загрузил коги. Также будет создан/обновлен файл `discord_bot.log`.
4.  Чтобы остановить бота, нажмите `Ctrl + C` в терминале.

## Добавление Бота на Сервер Discord

1.  Перейдите на [Портал Разработчиков Discord](https://discord.com/developers/applications).
2.  Выберите ваше приложение бота.
3.  Перейдите в "OAuth2" -> "URL Generator".
4.  В разделе "Scopes" выберите `bot`.
5.  В разделе "Bot Permissions" (появится ниже) выберите необходимые права:
    *   `Send Messages` (Отправлять сообщения) - Обязательно
    *   `Read Message History` (Читать историю сообщений) - Обязательно для команд
    *   `Read Messages/View Channels` (Читать сообщения/Просмотр каналов) - Обязательно
    *   `Embed Links` (Встраивать ссылки) - Обязательно для форматированных ответов
    *   *(Добавьте другие, если нужно для будущих функций)*
6.  Скопируйте "Generated URL" внизу страницы.
7.  Вставьте URL в ваш браузер.
8.  Выберите сервер, на который хотите добавить бота, и нажмите "Продолжить".
9.  Проверьте запрашиваемые права и нажмите "Авторизовать".
10. Пройдите CAPTCHA, если потребуется.

*(Для добавления бота на сервер у вас должно быть право "Управлять сервером").*

## Использование (Текущие Команды)

*   `!ping`
    *   Проверяет, онлайн ли бот, и показывает задержку API.
*   `!questhistory <EVM_адрес> [фильтр_по_имени_квеста]` или `!qh ...` или `!loyalty ...`
    *   Показывает историю выполненных квестов (начисления, кроме ежедневных Check-in) для указанного EVM адреса.
    *   Необязательно: можно добавить текст после адреса для фильтрации квестов по названию (регистр не учитывается).
    *   Пример (все квесты): `!qh 0xcdFbB78eb9455bE3ddF00AA5678c7F82836f2Fcb`
    *   Пример (фильтр): `!qh 0xcdFbB78eb9455bE3ddF00AA5678c7F82836f2Fcb Follow`