# Discord Snag API Bot

This Discord bot is designed to interact with the Snag Solutions API using a provided API key. It allows users to fetch specific data (like quest history) via Discord commands.

## Project Structure

discord_bot/
│
├── .env                # Stores secret keys (DISCORD_TOKEN, SNAG_API_KEY, PROXY_URL) - DO NOT SHARE!
├── README.md           # This file (or README_EN.md / README_RU.md)
├── bot.py              # Main bot script (initialization, loading cogs, running)
├── requirements.txt    # Python package dependencies
├── .gitignore          # Tells Git which files to ignore (like .env, venv)
├── discord_bot.log     # Log file generated by the bot
└── cogs/               # Folder containing the bot's command modules (Cogs)
    ├── __init__.py     # Makes 'cogs' a Python package
    ├── doc_commands.py # Example Cog for basic commands (like ping)
    └── snag_cog.py     # Cog containing Snag API specific commands (like questhistory)
└── venv/               # (Recommended) Virtual environment folder

## Setup Instructions

1.  **Clone or Copy:** Get a copy of the `discord_bot` project folder onto your local machine.
2.  **Python:** Ensure you have Python 3.8 or newer installed. You can download it from [python.org](https://www.python.org/downloads/).
3.  **Navigate to Folder:** Open your terminal or command prompt and navigate into the project directory:
    ```bash
    cd path/to/discord_bot
    ```
4.  **Create Virtual Environment (Recommended):** This isolates project dependencies.
    ```bash
    # Windows
    py -m venv venv
    # macOS/Linux
    python3 -m venv venv
    ```
5.  **Activate Virtual Environment:**
    ```bash
    # Windows (cmd.exe)
    .\venv\Scripts\activate.bat
    # Windows (PowerShell)
    .\venv\Scripts\Activate.ps1
    # Windows (Git Bash)
    source venv/Scripts/activate
    # macOS/Linux
    source venv/bin/activate
    ```
    *(You should see `(venv)` at the beginning of your terminal prompt)*
6.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

## Configuration (`.env` file)

1.  Create a file named `.env` in the root of the `discord_bot` directory.
2.  Add the following lines to the `.env` file, replacing the placeholder values with your actual keys:

    ```dotenv
    # .env - Secret Keys and Configuration
    DISCORD_TOKEN=YOUR_DISCORD_BOT_TOKEN_HERE
    SNAG_API_KEY=YOUR_SNAG_API_KEY_HERE

    # Optional: Proxy URL if needed (uncomment and fill ONE line)
    # PROXY_URL=http://YOUR_PROXY_HOST:PORT
    # PROXY_URL=http://USER:PASSWORD@YOUR_PROXY_HOST:PORT
    # PROXY_URL=socks5://YOUR_PROXY_HOST:PORT
    # PROXY_URL=socks5://USER:PASSWORD@YOUR_PROXY_HOST:PORT
    ```

3.  **IMPORTANT:**
    *   Never share your `.env` file.
    *   Do not commit this file to version control (Git). The included `.gitignore` file should prevent this automatically if you use Git.

## Running the Bot

1.  Make sure your virtual environment is activated (see step 5 in Setup).
2.  Run the main bot script from the `discord_bot` directory:
    ```bash
    # Windows
    py bot.py
    # macOS/Linux
    python3 bot.py
    ```
3.  You should see log messages in your terminal indicating the bot has logged in and loaded the cogs. A `discord_bot.log` file will also be created/updated.
4.  To stop the bot, press `Ctrl + C` in the terminal.

## Adding the Bot to a Discord Server

1.  Go to the [Discord Developer Portal](https://discord.com/developers/applications).
2.  Select your bot application.
3.  Navigate to "OAuth2" -> "URL Generator".
4.  In "Scopes", select `bot`.
5.  In "Bot Permissions" (which appears below), select the necessary permissions:
    *   `Send Messages` (Required)
    *   `Read Message History` (Required for commands)
    *   `Read Messages/View Channels` (Required to see commands)
    *   `Embed Links` (Required for formatted responses)
    *   *(Add others if needed for future features)*
6.  Copy the "Generated URL" at the bottom.
7.  Paste the URL into your browser.
8.  Select the server you want to add the bot to and click "Continue".
9.  Review the permissions and click "Authorize".
10. Complete the CAPTCHA if prompted.

*(You need the "Manage Server" permission on the target server to add bots).*

## Usage (Current Commands)

*   `!ping`
    *   Checks if the bot is online and shows API latency.
*   `!questhistory <EVM_address> [quest_name_filter]` or `!qh ...` or `!loyalty ...`
    *   Shows the history of completed quests (credits, excluding check-ins) for the specified EVM address.
    *   Optionally, you can add text after the address to filter quests by name (case-insensitive).
    *   Example (all quests): `!qh 0xcdFbB78eb9455bE3ddF00AA5678c7F82836f2Fcb`
    *   Example (filter): `!qh 0xcdFbB78eb9455bE3ddF00AA5678c7F82836f2Fcb Follow`